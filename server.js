const http    = require("http"),
      express = require('express'),
      dotenv  = require('dotenv');
//Env vars
dotenv.config({path:'./config/config.env'});
//Express 
const app = express();
const PORT = process.env.PORT || 5000;
//mongodb connection file
const con = require('./config/db');
con();

// Body parser
app.use(express.json());

//Routes
const apiRoutes = require('./Routes/ApiRoute'),
      webRoutes = require('./Routes/WebRoute') ;

app.use('/',webRoutes);
app.use('/api',apiRoutes);


const server = app.listen(
    PORT,
    console.log(`Server running in ${process.env.NODE_ENV} mode no port ${process.env.PORT} \nhttp://localhost:${process.env.PORT}`)
);
//Handle promise rejection errror
process.on('unhandledRejection',(err,promise)=>{
    console.error(`Error : ${err.message}`);
    //close server & exit process
    server.close(()=>process.exit(1));
});


// app.get('*',(req,res)=>{
//     res.write("<img src='data:image/png;base64,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'>");
// });

// node code

// const server =http.createServer((req,res)=>{
//     const {headers,url, method}= req;
//     // console.log(req);
//     // console.log("header "+headers+ " url "+url+" methods "+method);
//     res.statusCode=502;
//     res.setHeader("Content-Type","application/json");
//     res.write("<h1>Node Js Api</h1>");
//     res.end();
// });

// const PORT = 5000;

// server.listen(PORT,()=>console.log(`Server is running on port http://localhost:${PORT}`));

